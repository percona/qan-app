<hr/>
<h3 *ngIf="!isSummary">
  <div class="d-flex justify-content-between">
    <span>{{ queryDetails?.Query?.Abstract }}</span>
    <span>{{ queryDetails?.Query?.Id }}</span>
  </div>
</h3>
<h3 *ngIf="isSummary" class="d-inline">
  Server Summary
</h3>
<div class="card">
  <div class="card-header">
    Metrics
    <span *ngIf="!isSummary" class="pull-right">Query first seen: <i class="fa fa-clock-o"></i> {{ firstSeen }} <i
      class="fa fa-ellipsis-h" aria-hidden="true"></i> Last seen: <i class="fa fa-clock-o"></i> {{ lastSeen }}</span>
  </div>
  <table class="table table-striped table-hover table-sm mb-0 metrics">
    <thead>
    <tr>
      <th nowrap width="20%">Metrics</th>
      <th>Rate/Sec</th>
      <th>Sum</th>
      <th colspan="2">Per Query Stats</th>
    </tr>
    </thead>
    <tbody *ngIf="isLoading">
    <tr>
      <td colspan="6"><i class="fa fa-spinner fa-pulse fa-3x fa-fw loading"></i></td>
    </tr>
    </tbody>
    <tbody *ngIf="!isLoading">
    <tr>
      <td class="cell-overlay"><span>Query Count</span></td>
      <td class="no-right-border rate-sec cell-overlay" align="right">
        <span>{{ queryDetails?.Metrics2.Query_count_per_sec | humanize : 'number' }} (per sec)</span>
      </td>
      <td class="no-left-border rate-load">
        <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
             data-tooltip="Loading..." xkey="Ts" ykey="Query_count_per_sec" measurement="number"></div>
      </td>
      <td class="cell-overlay">
        <span class="sum">{{ queryDetails?.Metrics2.Query_count | humanize : 'number' }}
          <small>
            <span *ngIf="!isSummary" class="text-primary">
              {{ queryDetails?.Metrics2.Query_count_of_total | humanize : 'percent' }} of total
            </span>
          </small>
        </span>
      </td>
      <td colspan="2"></td>
    </tr>
    <tr>
      <td class="cell-overlay"><span>Query Time</span></td>
      <td class="no-right-border rate-sec cell-overlay" align="right">
        <span>{{ queryDetails?.Metrics2.Query_time_sum_per_sec | humanize : 'number' }} load</span>
      </td>
      <td class="no-left-border rate-load" widht="150px">
        <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
             data-tooltip="Loading..." xkey="Ts" ykey="Query_time_sum_per_sec" measurement="number"></div>
      </td>
      <td class="cell-overlay">
        <span class="sum">{{ queryDetails?.Metrics2.Query_time_sum | humanize : 'time' }}
          <small>
            <span *ngIf="!isSummary" class="text-primary">
              {{ queryDetails?.Metrics2.Query_time_sum_of_total | humanize : 'percent' }} of total
            </span>
          </small>
        </span>
      </td>
      <td class="text-xs-right no-right-border cell-overlay">
        <span>{{ queryDetails?.Metrics2.Query_time_avg | humanize : 'time' }}&nbsp;avg</span>
      </td>
      <td style="width: 10%" class="no-left-border">
        <div class="scaling-svg-container app-tooltip"
             data-tooltip="Loading..."
             [appLatencyChart]="queryDetails?.Metrics2"
             measurement="time"
             metricPrefix="Query_time"
        ></div>
      </td>
    </tr>
    <tr *ngIf="queryDetails?.Metrics2.Lock_time_sum">
      <td class="cell-overlay"><span>Lock Time</span></td>
      <td class="no-right-border rate-sec cell-overlay" align="right">
        <span>{{ queryDetails?.Metrics2.Lock_time_sum_per_sec | humanize : 'number' }} (avg load)</span>
      </td>
      <td class="no-left-border rate-load">
        <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
             data-tooltip="Loading..." xkey="Ts" ykey="Lock_time_sum_per_sec" measurement="number"></div>
      </td>
      <td class="cell-overlay">
        <span class="sum">{{ queryDetails?.Metrics2.Lock_time_sum | humanize : 'time' }}
          <small>
            <span *ngIf="!isSummary" class="text-primary">
              {{ queryDetails?.Metrics2.Lock_time_sum_of_total | humanize : 'percent'}} of total
            </span>
            <span class="text-success">
              {{ queryDetails?.Metrics2.Lock_time_avg_per_query_time | humanize : 'percent' }} of query time
            </span>
          </small>
        </span>
      </td>
      <td class="text-xs-right no-right-border cell-overlay">
        <span>{{ queryDetails?.Metrics2.Lock_time_avg | humanize : 'time' }}&nbsp;avg</span>
      </td>
      <td style="width: 10%" class="no-left-border">
        <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="time"
             [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="Lock_time"></div>
      </td>
    </tr>
    <tr *ngIf="queryDetails?.Metrics2.InnoDB_rec_lock_wait_sum">
      <td class="cell-overlay"><span>Innodb Row Lock Wait</span></td>
      <td class="no-right-border rate-sec cell-overlay" align="right">
        <span>{{ queryDetails?.Metrics2.InnoDB_rec_lock_wait_sum_per_sec | humanize :'number' }} (avg load)</span>
      </td>
      <td class="no-left-border rate-load">
        <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
             data-tooltip="Loading..." xkey="Ts" ykey="InnoDB_rec_lock_wait_sum_per_sec"
             measurement="number"></div>
      </td>
      <td class="cell-overlay">
        <span class="sum">{{ queryDetails?.Metrics2.InnoDB_rec_lock_wait_sum | humanize : 'time' }}
          <small>
            <span *ngIf="queryDetails?.Metrics2.InnoDB_rec_lock_wait_sum_of_total" class="text-primary">
              {{ queryDetails?.Metrics2.InnoDB_rec_lock_wait_sum_of_total | humanize : 'percent' }} of total
            </span>
            <span class="text-success">
              {{ queryDetails?.Metrics2.InnoDB_rec_lock_wait_avg_per_query_time | humanize : 'percent' }} of query time
            </span>
          </small>
        </span>
      </td>
      <td class="text-xs-right no-right-border cell-overlay">
        <span>{{ queryDetails?.Metrics2.InnoDB_rec_lock_wait_avg | humanize : 'time' }}&nbsp;avg</span>
      </td>
      <td style="width: 10%" class="no-left-border">
        <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="time"
             [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="InnoDB_rec_lock_wait"></div>
      </td>
    </tr>
    <tr *ngIf="queryDetails?.Metrics2.InnoDB_IO_r_wait_sum">
      <td class="cell-overlay"><span>Innodb IO Read Wait</span></td>
      <td class="no-right-border cell-overlay rate-sec" align="right">
        <span>{{ queryDetails?.Metrics2.InnoDB_IO_r_wait_sum_per_sec | humanize :'number' }} (avg load)</span>
      </td>
      <td class="no-left-border rate-load">
        <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
             data-tooltip="Loading..." xkey="Ts" ykey="InnoDB_IO_r_wait_sum_per_sec"
             measurement="number"></div>
      </td>
      <td class="cell-overlay">
        <span class="sum">{{ queryDetails?.Metrics2.InnoDB_IO_r_wait_sum | humanize : 'time' }}
          <small>
            <span *ngIf="!isSummary" class="text-primary">
              {{ queryDetails?.Metrics2.InnoDB_IO_r_wait_sum_of_total | humanize : 'percent' }} of total
            </span>
            <span class="text-success">
              {{ queryDetails?.Metrics2.InnoDB_IO_r_wait_avg_per_query_time | humanize : 'percent' }} of query time
            </span>
          </small>
        </span>
      </td>
      <td class="text-xs-right no-right-border cell-overlay">
        <span>{{ queryDetails?.Metrics2.InnoDB_IO_r_wait_avg | humanize : 'time' }}&nbsp;avg</span>
      </td>
      <td style="width: 10%" class="no-left-border">
        <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="time"
             [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="InnoDB_IO_r_wait"></div>
      </td>
    </tr>
    <tr *ngIf="queryDetails?.Metrics2.InnoDB_queue_wait_sum">
      <td class="cell-overlay"><span>Innodb Queue Wait</span></td>
      <td class="no-right-border cell-overlay rate-sec" align="right">
        <span>{{ queryDetails?.Metrics2.InnoDB_queue_wait_sum_per_sec | humanize :'number'}} (avg load)</span>
      </td>
      <td class="no-left-border rate-load">
        <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
             data-tooltip="Loading..." xkey="Ts" ykey="InnoDB_queue_wait_sum_per_sec"
             measurement="number"></div>
      </td>
      <td class="cell-overlay">
        <span class="sum">{{ queryDetails?.Metrics2.InnoDB_queue_wait_sum | humanize : 'time'}}
          <small>
            <span *ngIf="!isSummary" class="text-primary">
              {{ queryDetails?.Metrics2.InnoDB_queue_wait_sum_of_total | humanize : 'percent' }} of total
            </span>
            <span class="text-success">
              {{ queryDetails?.Metrics2.innodbQueueWait.InnoDB_queue_wait_avg_per_query_time | humanize : 'percent' }} of query time
            </span>
          </small>
        </span>
      </td>
      <td class="text-xs-right no-right-border cell-overlay">
        <span>{{ queryDetails?.Metrics2.InnoDB_queue_wait_avg | humanize : 'time' }}&nbsp;avg</span>
      </td>
      <td style="width: 10%" class="no-left-border">
        <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="time"
             [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="InnoDB_queue_wait"></div>
      </td>
    </tr>
    <tr *ngIf="queryDetails?.Metrics2.InnoDB_IO_r_ops_sum">
      <td class="cell-overlay"><span>Innodb Read Ops</span></td>
      <td class="no-right-border cell-overlay rate-sec" align="right">
        <span>{{ queryDetails?.Metrics2.InnoDB_IO_r_ops_sum_per_sec | humanize :'number' }} (per sec)</span>
      </td>
      <td class="no-left-border rate-load">
        <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
             data-tooltip="Loading..." xkey="Ts" ykey="InnoDB_IO_r_ops_sum_per_sec"
             measurement="number"></div>
      </td>
      <td class="cell-overlay">
        <span class="sum">{{ queryDetails?.Metrics2.InnoDB_IO_r_ops_sum | humanize : 'number' }}
          <small>
            <span *ngIf="!isSummary" class="text-primary">
              {{ queryDetails?.Metrics2.InnoDB_IO_r_ops_sum_of_total | humanize : 'percent' }} of total
            </span>
          </small>
        </span>
      </td>
      <td class="text-xs-right no-right-border cell-overlay">
        <span>{{ queryDetails?.Metrics2.InnoDB_IO_r_ops_avg | humanize : 'number' }}&nbsp;avg</span>
      </td>
      <td style="width: 10%" class="no-left-border">
        <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="number"
             [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="InnoDB_IO_r_ops"></div>
      </td>
    </tr>
    <tr *ngIf="queryDetails?.Metrics2.InnoDB_IO_r_bytes_sum">
      <td class="cell-overlay"><span>Innodb Read Bytes</span></td>
      <td class="no-right-border cell-overlay rate-sec" align="right">
        <span>{{ queryDetails?.Metrics2.InnoDB_IO_r_bytes_sum_per_sec | humanize :'size'}} (per sec)</span>
      </td>
      <td class="no-left-border rate-load">
        <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
             data-tooltip="Loading..." xkey="Ts" ykey="InnoDB_IO_r_bytes_sum_per_sec"
             measurement="size"></div>
      </td>
      <td class="cell-overlay">
        <span class="sum">{{ queryDetails?.Metrics2.InnoDB_IO_r_bytes_sum | humanize : 'size' }}
          <small>
            <span *ngIf="!isSummary" class="text-primary">
              {{ queryDetails?.Metrics2.InnoDB_IO_r_bytes_sum_of_total | humanize : 'percent' }} of total
            </span>
            <span class="text-success">
              {{ queryDetails?.Metrics2.InnoDB_IO_r_bytes_sum_per_io | humanize : 'size' }} avg io size
            </span>
          </small>
        </span>
      </td>
      <td class="text-xs-right no-right-border cell-overlay">
        <span>{{ queryDetails?.Metrics2.InnoDB_IO_r_bytes_avg | humanize : 'size' }}&nbsp;avg</span>
      </td>
      <td style="width: 10%" class="no-left-border">
        <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="size"
             [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="InnoDB_IO_r_bytes"></div>
      </td>
    </tr>
    <tr *ngIf="queryDetails?.Metrics2.InnoDB_pages_distinct_sum">
      <td class="cell-overlay"><span>Innodb Distinct Pages</span></td>
      <td colspan="2" align="right">-</td>
      <td><span class="sum">-</span></td>
      <td class="text-xs-right no-right-border cell-overlay rate-sec">
        <span>{{ queryDetails?.Metrics2.InnoDB_pages_distinct_avg | humanize : 'number' }}&nbsp;avg</span>
      </td>
      <td style="width: 10%" class="no-left-border rate-load">
        <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="number"
             [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="InnoDB_pages_distinct"></div>
      </td>
    </tr>
    <tr *ngIf="queryDetails?.Metrics2.QC_Hit_sum">
      <td class="cell-overlay"><span>Query Cache Hits</span></td>
      <td class="no-right-border cell-overlay rate-sec" align="right">
        <span>{{ queryDetails?.Metrics2.QC_Hit_sum_per_sec | humanize : 'number' }} (per sec)</span>
      </td>
      <td class="no-left-border rate-load">
        <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
             data-tooltip="Loading..." xkey="Ts" ykey="QC_Hit_sum_per_sec" measurement="number"></div>
      </td>
      <td class="cell-overlay">
        <span class="sum">{{ queryDetails?.Metrics2.QC_Hit_sum | humanize : 'number' }}
          <small>
            <span *ngIf="!isSummary" class="text-primary">
              {{ queryDetails?.Metrics2.QC_Hit_sum_of_total | humanize : 'percent' }} of total
            </span>
            <span class="text-success">
              {{ queryDetails?.Metrics2.QC_Hit_sum_per_query | humanize : 'percent'}} QC hit ratio
            </span>
          </small>
        </span>
      </td>
      <td class="text-xs-right no-right-border">
        -
      </td>
      <td style="width: 10%" class="no-left-border">
      </td>
    </tr>
    <tr *ngIf="queryDetails?.Metrics2.Rows_sent_sum">
      <td class="cell-overlay"><span>Rows Sent</span></td>
      <td class="no-right-border cell-overlay rate-sec" align="right">
        <span>{{ queryDetails?.Metrics2.Rows_sent_sum_per_sec | humanize : 'number' }} (per sec)</span>
      </td>
      <td class="no-left-border rate-load">
        <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
             data-tooltip="Loading..." xkey="Ts" ykey="Rows_sent_sum_per_sec" measurement="number"></div>
      </td>
      <td class="cell-overlay">
        <span class="sum">{{ queryDetails?.Metrics2.Rows_sent_sum | humanize : 'number' }}
          <small>
            <span *ngIf="!isSummary" class="text-primary">
              {{ queryDetails?.Metrics2.Rows_sent_sum_of_total | humanize : 'percent' }} of total
            </span>
          </small>
        </span>
      </td>
      <td class="text-xs-right no-right-borderv cell-overlay">
        <span>{{ queryDetails?.Metrics2.Rows_sent_avg | humanize : 'number' }}&nbsp;avg</span>
      </td>
      <td style="width: 10%" class="no-left-border">
        <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="number"
             [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="Rows_sent"></div>
      </td>
    </tr>
    <tr *ngIf="queryDetails?.Metrics2.Bytes_sent_sum">
      <td class="cell-overlay"><span>Bytes Sent</span></td>
      <td class="no-right-border cell-overlay rate-sec" align="right">
        <span>{{ queryDetails?.Metrics2.Bytes_sent_sum_per_sec | humanize : 'size' }} (per sec)</span>
      </td>
      <td class="no-left-border rate-load">
        <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
             data-tooltip="Loading..." xkey="Ts" ykey="Bytes_sent_sum_per_sec" measurement="size"></div>
      </td>
      <td class="cell-overlay">
        <span class="sum">{{ queryDetails?.Metrics2.Bytes_sent_sum | humanize : 'size' }}
          <small>
            <span *ngIf="!isSummary" class="text-primary">
              {{ queryDetails?.Metrics2.Bytes_sent_sum_of_total | humanize : 'percent' }} of total
            </span>
            <span class="text-success" ng-if="queryDetails?.Metrics2.Bytes_sent_sum_per_rows">
              {{ queryDetails?.Metrics2.Bytes_sent_sum_per_rows | humanize : 'size' }} bytes/row
            </span>
          </small>
        </span>
      </td>
      <td class="text-xs-right no-right-border cell-overlay">
        <span>{{ queryDetails?.Metrics2.Bytes_sent_avg | humanize : 'size' }}&nbsp;avg</span>
      </td>
      <td style="width: 10%" class="no-left-border">
        <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="size"
             [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="Bytes_sent"></div>
      </td>
    </tr>
    <tr *ngIf="queryDetails?.Metrics2.Rows_examined_sum">
      <td class="cell-overlay"><span>Rows Examined</span></td>
      <td class="no-right-border cell-overlay rate-sec" align="right">
        <span>{{ queryDetails?.Metrics2.Rows_examined_sum_per_sec | humanize : 'number' }} (per sec)</span>
      </td>
      <td class="no-left-border rate-load">
        <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
             data-tooltip="Loading..." xkey="Ts" ykey="Rows_examined_sum_per_sec" measurement="number"></div>
      </td>
      <td class="cell-overlay">
        <span class="sum">{{ queryDetails?.Metrics2.Rows_examined_sum | humanize : 'number' }}
          <small>
            <span *ngIf="!isSummary" class="text-primary">
              {{ queryDetails?.Metrics2.Rows_examined_sum_of_total | humanize : 'percent' }} of total
            </span>
            <span class="text-success">
              {{ queryDetails?.Metrics2.Rows_examined_sum_per_rows | humanize : 'number' }} per row sent
            </span>
          </small>
        </span>
      </td>
      <td class="text-xs-right no-right-border cell-overlay">
        <span>{{ queryDetails?.Metrics2.Rows_examined_avg | humanize : 'number' }}&nbsp;avg</span>
      </td>
      <td style="width: 10%" class="no-left-border">
        <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="number"
             [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="Rows_examined"></div>
      </td>
    </tr>
    <tr *ngIf="queryDetails?.Metrics2.Rows_affected_sum">
      <td class="cell-overlay"><span>Rows Affected</span></td>
      <td class="no-right-border cell-overlay rate-sec" align="right">
        <span>{{ queryDetails?.Metrics2.Rows_affected_sum_per_sec | humanize : 'number' }} (per sec)</span>
      </td>
      <td class="no-left-border rate-load">
        <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
             data-tooltip="Loading..." xkey="Ts" ykey="Rows_affected_sum_per_sec" measurement="number"></div>
      </td>
      <td class="cell-overlay">
        <span class="sum">{{ queryDetails?.Metrics2.Rows_affected_sum | humanize : 'number'}}
          <small>
            <span *ngIf="!isSummary" class="text-primary">
              {{ queryDetails?.Metrics2.Rows_affected_sum_of_total | humanize : 'percent' }} of total
            </span>
          </small>
        </span>
      </td>
      <td class="text-xs-right no-right-border cell-overlay">
        <span>{{ queryDetails?.Metrics2.Rows_affected_avg | humanize : 'number' }}&nbsp;avg</span>
      </td>
      <td style="width: 10%" class="no-left-border">
        <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="number"
             [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="Rows_affected"></div>
      </td>
    </tr>
    <tr *ngIf="queryDetails?.Metrics2.Filesort_sum">
      <!-- no avg -->
      <td class="cell-overlay">
        <span>External Sorts
          <small>(Filesort)</small>
        </span>
      </td>
      <td class="no-right-border cell-overlay rate-sec" align="right">
        <span>{{ queryDetails?.Metrics2.Filesort_sum_per_sec | humanize : 'number' }} (per sec)</span>
      </td>
      <td class="no-left-border rate-load">
        <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
             data-tooltip="Loading..." xkey="Ts" ykey="Filesort_sum_per_sec" measurement="number"></div>
      </td>
      <td class="cell-overlay">
        <span class="sum">{{ queryDetails?.Metrics2.Filesort_sum | humanize : 'number' }}
          <small>
            <span *ngIf="!isSummary" class="text-primary">
              {{ queryDetails?.Metrics2.Filesort_sum_of_total | humanize : 'percent' }} of total
            </span>
            <span class="text-success">
              {{ queryDetails?.Metrics2.Filesort_sum_per_query | humanize : 'percent' }} of queries
            </span>
          </small>
        </span>
      </td>
      <td class="text-xs-right no-right-border">
        -
      </td>
      <td style="width: 10%" class="no-left-border">
      </td>
    </tr>
    <tr *ngIf="queryDetails?.Metrics2.Filesort_on_disk_sum">
      <td class="cell-overlay">
        <span>External Sorts of Disk
          <small>(Filesort on disk)</small>
        </span>
      </td>
      <td class="no-right-border cell-overlay rate-sec" align="right">
        <span>{{ queryDetails?.Metrics2.Filesort_on_disk_sum_per_sec | humanize : 'number' }} (per sec)</span>
      </td>
      <td class="no-left-border rate-load">
        <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
             data-tooltip="Loading..." xkey="Ts" ykey="Filesort_on_disk_sum_per_sec"
             measurement="number"></div>
      </td>
      <td class="cell-overlay">
        <span class="sum">{{ queryDetails?.Metrics2.Filesort_on_disk_sum | humanize : 'number' }}
          <small>
            <span *ngIf="!isSummary" class="text-primary">
              {{ queryDetails?.Metrics2.Filesort_on_disk_sum_of_total | humanize : 'percent' }} of total
            </span>
            <span class="text-success">
              {{ queryDetails?.Metrics2.Filesort_on_disk_sum_per_query | humanize : 'percent' }} of queries
            </span>
          </small>
        </span>
      </td>
      <td class="text-xs-right no-right-border">
        -
      </td>
      <td style="width: 10%" class="no-left-border">
      </td>
    </tr>
    <tr *ngIf="queryDetails?.Metrics2.Merge_passes_sum">
      <td>
        <span>External Sort Passes
          <small>(Merge Passes)</small>
        </span>
      </td>
      <td class="no-right-border cell-overlay rate-sec" align="right">
        <span>{{ queryDetails?.Metrics2.Merge_passes_sum_per_sec | humanize : 'number' }} (per sec)</span>
      </td>
      <td class="no-left-border rate-load">
        <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
             data-tooltip="Loading..." xkey="Ts" ykey="Merge_passes_sum_per_sec" measurement="number"></div>
      </td>
      <td class="cell-overlay">
        <span class="sum">{{ queryDetails?.Metrics2.Merge_passes_sum | humanize : 'number' }}
          <small>
            <span *ngIf="!isSummary" class="text-primary">
              {{ queryDetails?.Metrics2.Merge_passes_sum_of_total | humanize : 'percent' }} of total
            </span>
            <span class="text-success">
              {{ queryDetails?.Metrics2.Merge_passes_sum_per_external_sort | humanize : 'percent' }} per external sort
            </span>
          </small>
        </span>
      </td>
      <td class="text-xs-right no-right-border cell-overlay">
        <span>{{ queryDetails?.Metrics2.Merge_passes_avg | humanize : 'number' }}&nbsp;avg</span>
      </td>
      <td style="width: 10%" class="no-left-border">
        <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="number"
             [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="Merge_passes"></div>
      </td>
    </tr>
    <tr *ngIf="queryDetails?.Metrics2.Full_join_sum">
      <td>
        <span>Cartesian Products
          <small>(Full Joins)</small>
        </span>
      </td>
      <td class="no-right-border" align="right">
        <span>{{ queryDetails?.Metrics2.Full_join_sum_per_sec | humanize : 'number' }} (per sec)</span>
      </td>
      <td class="no-left-border rate-load">
        <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
             data-tooltip="Loading..." xkey="Ts" ykey="Full_join_sum_per_sec" measurement="number"></div>
      </td>
      <td class="cell-overlay">
        <span class="sum">{{ queryDetails?.Metrics2.Full_join_sum | humanize : 'number' }}
          <small>
            <span *ngIf="!isSummary" class="text-primary">
              {{ queryDetails?.Metrics2.Full_join_sum_of_total | humanize : 'percent' }} of total
            </span>
            <span class="text-success">
              {{ queryDetails?.Metrics2.Full_join_sum_per_query | humanize : 'percent' }} of queries
            </span>
          </small>
        </span>
      </td>
      <td class="text-xs-right no-right-border">
        -
      </td>
      <td style="width: 10%" class="no-left-border">
      </td>
    </tr>
    <tr *ngIf="queryDetails?.Metrics2.Full_scan_sum">
      <td class="cell-overlay"><span>Full Table Scans</span></td>
      <td class="no-right-border cell-overlay rate-sec" align="right">
        <span>{{ queryDetails?.Metrics2.Full_scan_sum_per_sec | humanize : 'number' }} (per sec)</span>
      </td>
      <td class="no-left-border rate-load">
        <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
             data-tooltip="Loading..." xkey="Ts" ykey="Full_scan_sum_per_sec" measurement="number"></div>
      </td>
      <td class="cell-overlay">
        <span class="sum">{{ queryDetails?.Metrics2.Full_scan_sum | humanize : 'number' }}
          <small>
            <span *ngIf="!isSummary" class="text-primary">
              {{ queryDetails?.Metrics2.Full_scan_sum_of_total | humanize : 'percent' }} of total
            </span>
            <span class="text-success">
              {{ queryDetails?.Metrics2.Full_scan_sum_per_query | humanize : 'percent' }} of queries
            </span>
          </small>
        </span>
      </td>
      <td class="text-xs-right no-right-border">
        -
      </td>
      <td style="width: 10%" class="no-left-border">
      </td>
    </tr>
    <tr *ngIf="queryDetails?.Metrics2.Tmp_table_sum">
      <td class="cell-overlay"><span>Queries Requiring Tmp Table In Memory</span></td>
      <td class="no-right-border cell-overlay rate-sec" align="right">
        <span>{{ queryDetails?.Metrics2.Tmp_table_sum_per_sec | humanize : 'number' }} (per sec)</span>
      </td>
      <td class="no-left-border rate-load">
        <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
             data-tooltip="Loading..." xkey="Ts" ykey="Tmp_table_sum_per_sec" measurement="number"></div>
      </td>
      <td class="cell-overlay">
        <span class="sum">{{ queryDetails?.Metrics2.Tmp_table_sum | humanize : 'number' }}
          <small>
            <span *ngIf="!isSummary" class="text-primary">
              {{ queryDetails?.Metrics2.Tmp_table_sum_of_total | humanize : 'percent' }} of total
            </span>
            <span class="text-success">
              {{ queryDetails?.Metrics2.Tmp_table_sum_per_query | humanize : 'percent' }} of queries
            </span>
          </small>
        </span>
      </td>
      <td class="text-xs-right no-right-border">
        -
      </td>
      <td style="width: 10%" class="no-left-border">
      </td>
    </tr>
    <tr *ngIf="queryDetails?.Metrics2.Tmp_tables_sum">
      <td class="cell-overlay"><span>Number of Tmp table in Memory</span></td>
      <td class="no-right-border cell-overlay rate-sec" align="right">
        <span>{{ queryDetails?.Metrics2.Tmp_tables_sum_per_sec | humanize : 'number' }} (per sec)</span>
      </td>
      <td class="no-left-border rate-load">
        <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
             data-tooltip="Loading..." xkey="Ts" ykey="Tmp_tables_sum_per_sec" measurement="number"></div>
      </td>
      <td class="cell-overlay">
        <span class="sum">{{ queryDetails?.Metrics2.Tmp_tables_sum | humanize : 'number' }}
          <small>
            <span *ngIf="!isSummary" class="text-primary">
              {{ queryDetails?.Metrics2.Tmp_tables_sum_of_total | humanize : 'percent' }} of total
            </span>
            <span class="text-success">
              {{ queryDetails?.Metrics2.Tmp_tables_sum_per_query_with_tmp_table | humanize : 'number'}} per query with tmp table
            </span>
          </small>
        </span>
      </td>
      <td class="text-xs-right no-right-border cell-overlay">
        <span>{{ queryDetails?.Metrics2.Tmp_tables_avg | humanize : 'number' }}&nbsp;avg</span>
      </td>
      <td style="width: 10%" class="no-left-border">
        <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="number"
             [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="Tmp_tables"></div>
      </td>
    </tr>
    <tr *ngIf="queryDetails?.Metrics2.Tmp_table_on_disk_sum">
      <td class="cell-overlay"><span>Queries Requiring Tmp Table on Disk</span></td>
      <td class="no-right-border cell-overlay rate-sec" align="right">
        <span>{{ queryDetails?.Metrics2.Tmp_table_on_disk_sum_per_sec | humanize : 'number' }} (per sec)</span>
      </td>
      <td class="no-left-border rate-load">
        <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
             data-tooltip="Loading..." xkey="Ts" ykey="Tmp_table_on_disk_sum_per_sec"
             measurement="number"></div>
      </td>
      <td class="cell-overlay">
        <span class="sum">{{ queryDetails?.Metrics2.Tmp_table_on_disk_sum | humanize : 'number' }}
          <small>
            <span *ngIf="!isSummary" class="text-primary">
              {{ queryDetails?.Metrics2.Tmp_table_on_disk_sum_of_total | humanize : 'percent' }} of total
            </span>
            <span class="text-success">
              {{ queryDetails?.Metrics2.Tmp_table_on_disk_sum_per_query | humanize : 'percent' }} of queries
            </span>
          </small>
        </span>
      </td>
      <td class="text-xs-right no-right-border">
        -
      </td>
      <td style="width: 10%" class="no-left-border">
      </td>
    </tr>
    <tr *ngIf="queryDetails?.Metrics2.Tmp_disk_tables_sum">
      <td class="cell-overlay"><span>Number of Tmp Tables on Disk</span></td>
      <td class="no-right-border cell-overlay rate-sec" align="right">
        <span>{{ queryDetails?.Metrics2.Tmp_disk_tables_sum_per_sec | humanize : 'number' }} (per sec)</span>
      </td>
      <td class="no-left-border rate-load">
        <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
             data-tooltip="Loading..." xkey="Ts" ykey="Tmp_disk_tables_sum_per_sec"
             measurement="number"></div>
      </td>
      <td class="cell-overlay">
        <span class="sum">{{ queryDetails?.Metrics2.Tmp_disk_tables_sum | humanize : 'number' }}
          <small>
            <span *ngIf="!isSummary" class="text-primary">
              {{ queryDetails?.Metrics2.Tmp_disk_tables_sum_of_total | humanize : 'percent' }} of total
            </span>
            <span class="text-success">
              {{ queryDetails?.Metrics2.Tmp_disk_tables_sum_per_query_with_tmp_table | humanize : 'number' }} per query with disk tmp table
            </span>
          </small>
        </span>
      </td>
      <td class="text-xs-right no-right-border cell-overlay">
        <span>{{ queryDetails?.Metrics2.Tmp_disk_tables_avg | humanize : 'number' }}&nbsp;avg</span>
      </td>
      <td style="width: 10%" class="no-left-border">
        <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="number"
             [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="Tmp_disk_tables"></div>
      </td>
    </tr>
    <tr *ngIf="queryDetails?.Metrics2.Tmp_table_sizes_sum">
      <td class="cell-overlay"><span>Total Size of Tmp Tables</span></td>
      <td class="no-right-border cell-overlay rate-sec" align="right">
        <span>{{ queryDetails?.Metrics2.Tmp_table_sizes_sum_per_sec | humanize : 'size' }} (per sec)</span>
      </td>
      <td class="no-left-border rate-load">
        <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
             data-tooltip="Loading..." xkey="Ts" ykey="Tmp_table_sizes_sum_per_sec"
             measurement="size"></div>
      </td>
      <td class="cell-overlay">
        <span class="sum">{{ queryDetails?.Metrics2.Tmp_table_sizes_sum | humanize : 'size' }}
          <small>
            <span *ngIf="!isSummary" class="text-primary">
              {{ queryDetails?.Metrics2.Tmp_table_sizes_sum_of_total | humanize : 'percent' }} of total
            </span>
            <span class="text-success">
              {{ queryDetails?.Metrics2.Tmp_table_sizes_sum_per_query_with_any_tmp_table | humanize : 'size' }} per query
            </span>
          </small>
        </span>
      </td>
      <td class="text-xs-right no-right-border cell-overlay">
        <span>{{ queryDetails?.Metrics2.Tmp_table_sizes_avg | humanize : 'size' }}&nbsp;avg</span>
      </td>
      <td style="width: 10%" class="no-left-border">
        <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="size"
             [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="Tmp_table_sizes"></div>
      </td>
    </tr>
    </tbody>
  </table>

</div>

<!--- additional info for query only-->
<div *ngIf="!isSummary">
  <hr/>
  <h3 class="d-inline">QUERY</h3>
  <ngb-accordion activeIds="query-fingerprint">
    <ngb-panel id="query-fingerprint">
      <ng-template ngbPanelTitle>
        <h5>Fingerprint</h5>
      </ng-template>
      <ng-template ngbPanelContent>
        <i *ngIf="isLoading" class="fa fa-spinner fa-pulse fa-3x fa-fw loading"></i>
        <pre *ngIf="!isLoading" style="margin: 1rem"><code [innerHTML]="fingerprint" id="query_fingerprint_code"></code></pre>
      </ng-template>
    </ngb-panel>
    <ngb-panel *ngIf="!!queryExample" id="query-example">
      <ng-template ngbPanelTitle>
        <h5>Example</h5>
      </ng-template>
      <ng-template ngbPanelContent>
        <i *ngIf="isLoading" class="fa fa-spinner fa-pulse fa-3x fa-fw loading"></i>
        <pre *ngIf="!isLoading" style="margin: 1rem"><code [innerHTML]="queryExample"
                                                           id="query_example_code"></code></pre>
      </ng-template>
    </ngb-panel>
  </ngb-accordion>

  <hr *ngIf="!!queryExample"/>
  <div class="row" *ngIf="!!queryExample">
    <span class="col-md-2">
        <h3 class="d-inline">EXPLAIN</h3>
    </span>
    <div class="col-md-10">
      <form class="form-inline pull-right">
        <div class="input-group">
                <span class="input-group-addon" id="sizing-addon1" title="Database">
                    <i class="fa fa-database" aria-hidden="true"></i>
                </span>
          <input type="text" size="50" class="form-control" [(ngModel)]="dbName" [ngModelOptions]="{standalone: true}"
                 id="databaseInput"
                 placeholder="`database-name`">
          <span class="input-group-btn">
                    <button class="btn btn-primary" [disabled]="!dbName" style="width: 8em" (click)="getExplain();"
                            type="submit">EXPLAIN</button>
                </span>
        </div>
      </form>
    </div>
  </div>
  <br/>
  <ngb-accordion activeIds="classic-explain" *ngIf="!!queryExample">
    <ngb-panel id="classic-explain">
      <ng-template ngbPanelTitle>
        <h5>CLASSIC</h5>
      </ng-template>
      <ng-template ngbPanelContent>
        <i *ngIf="isExplainLoading" class="fa fa-spinner fa-pulse fa-3x fa-fw loading"></i>
        <div *ngIf="!isExplainLoading && classicExplainError" class="alert alert-warning w-75 mx-auto m-2" role="alert">
          <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
          {{ jsonExplainError }}
        </div>
        <table *ngIf="!isExplainLoading && !classicExplainError" class="table table-striped table-hover table-sm ma-0">
          <thead>
          <tr>
            <th width="3%" title="Id">Id</th>
            <th title="SelectType">SelectType</th>
            <th title="Table">Table</th>
            <th title="Partitions">Partitions</th>
            <th title="CreateTable">CreateTable</th>
            <th title="Type">Type</th>
            <th title="PossibleKeys">PossibleKeys</th>
            <th title="Key">Key</th>
            <th title="KeyLen">KeyLen</th>
            <th width="5%" title="Ref">Ref</th>
            <th title="Rows">Rows</th>
            <th title="Extra">Extra</th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let row of classicExplain">
            <td [attr.title]="row.Id">{{ row.Id }}</td>
            <td [attr.title]="row.SelectType">{{ row.SelectType }}</td>
            <td [attr.title]="row.Table">{{ row.Table }}</td>
            <td [attr.title]="row.Partitions">{{ row.Partitions }}</td>
            <td [attr.title]="row.CreateTable">{{ row.CreateTable }}</td>
            <td [attr.title]="row.Type">{{ row.Type }}</td>
            <td [attr.title]="row.PossibleKeys">{{ row?.PossibleKeys?.replace(',', ', ') }}</td>
            <td [attr.title]="row.Key">{{ row.Key }}</td>
            <td [attr.title]="row.KeyLen">{{ row.KeyLen }}</td>
            <td [attr.title]="row.Ref">{{ row.Ref }}</td>
            <td [attr.title]="row.Rows">{{ row.Rows }}</td>
            <td [attr.title]="row.Extra">{{ row.Extra }}</td>
          </tr>
          </tbody>
        </table>
      </ng-template>
    </ngb-panel>

    <ngb-panel id="json-explain" *ngIf="!!jsonExplain || !!jsonExplainError">
      <ng-template ngbPanelTitle>
        <h5>JSON</h5>
      </ng-template>
      <ng-template ngbPanelContent>
        <i *ngIf="isExplainLoading" class="fa fa-spinner fa-pulse fa-3x fa-fw loading"></i>
        <app-json-tree [json]="jsonExplain" *ngIf="!isExplainLoading && !jsonExplainError"></app-json-tree>
        <div *ngIf="!isExplainLoading && jsonExplainError" class="alert alert-warning w-75 mx-auto m-2" role="alert">
          <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
          {{ jsonExplainError }}
        </div>
      </ng-template>
    </ngb-panel>
  </ngb-accordion>

  <hr/>
  <div class="row">
    <span class="col-md-2">
        <h3 class="d-inline">TABLES</h3>
    </span>
    <div class="col-md-10">
      <form class="form-inline pull-right" (submit)="addDBTable();">
        <label for="dbTblNamesInput">DB and table</label>&nbsp;
        <div class="input-group">
          <input type="text" size="50" class="form-control"
                 id="dbTblNamesInput" [(ngModel)]="newDBTblNames"
                 [ngModelOptions]="{standalone: true}"
                 placeholder="`database-name`.`table-name`">
          <span class="input-group-btn">
                    <button [disabled]="isDemo || !newDBTblNames" class="btn btn-primary" (click)="addDBTable();"
                            style="width: 8em" type="submit">ADD</button>
                </span>
        </div>
      </form>
    </div>
  </div>

  <br/>

  <div class="row">
    <div class="col-md-12">
      <div class="card w-100">
        <div class="card-block" id="db_tables_buttons">
          <div class="card-text pt-1 pr-1">
            <div *ngFor="let item of queryDetails?.Query?.Tables" class="btn-group ml-1 mb-1" role="group"
                 aria-label="Tables">
              <button type="button" class="btn" (click)="selectTableInfo(item.Db, item.Table);"
                      [ngClass]="isSelectedDbTbl(item) ? 'btn-success' : 'btn-secondary'">
                `{{ item.Db }}`.`{{ item.Table }}`
              </button>
              <button type="button" class="btn btn-warning" (click)="removeDBTable(item);"><i class="fa fa-times"
                                                                                              aria-hidden="true"></i>
              </button>
            </div>
            <div *ngIf="queryDetails?.Query?.Tables === null || queryDetails?.Query?.Tables?.length === 0"
                 class="alert alert-info w-25 mx-auto m-2" role="alert">
              <i class="fa fa-info-circle" aria-hidden="true"></i>
              List of tables is empty.
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <br/>
  <ngb-accordion activeIds="table-create" *ngIf="queryDetails?.Query?.Tables?.length">
    <ngb-panel id="table-create">
      <ng-template ngbPanelTitle>
        <h5>CREATE</h5>
      </ng-template>
      <ng-template ngbPanelContent>
        <i *ngIf="isTableInfoLoading" class="fa fa-spinner fa-pulse fa-3x fa-fw loading"></i>
        <div *ngIf="!isTableInfoLoading && createTableError" class="alert alert-warning w-75 mx-auto m-2" role="alert">
          <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
          {{ createTableError }}
        </div>
        <pre *ngIf="!isTableInfoLoading && !createTableError" style="margin: 1rem"><code [innerHTML]="createTable"
                                                                                         id="table_create"></code></pre>
      </ng-template>
    </ngb-panel>

    <ngb-panel id="table-status">
      <ng-template ngbPanelTitle>
        <h5>STATUS</h5>
      </ng-template>
      <ng-template ngbPanelContent>
        <i *ngIf="isTableInfoLoading" class="fa fa-spinner fa-pulse fa-3x fa-fw loading"></i>
        <div *ngIf="!isTableInfoLoading && !!statusTableError" class="alert alert-warning w-75 mx-auto m-2"
             role="alert">
          <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
          {{ statusTableError }}
        </div>
        <table *ngIf="!isTableInfoLoading && !statusTableError" class="table table-striped table-hover table-sm ma-0">
          <thead>
          <tr>
            <th>Name</th>
            <th>Value</th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let item of tableInfo?.Status | mapToIterable">
            <td>{{ item.key }}</td>
            <td
              *ngIf="['AvgRowLength', 'DataLength', 'IndexLength', 'DataFree', 'MaxDataLength'].indexOf(item.key) > -1">
              {{ item.val | humanize : 'size' }}
            </td>
            <td *ngIf="['Rows'].indexOf(item.key) > -1">{{ item.val | humanize : 'number' }}</td>
            <td
              *ngIf="['Rows', 'AvgRowLength', 'DataLength', 'IndexLength', 'DataFree', 'MaxDataLength'].indexOf(item.key) === -1">
              {{ item.val === null ? '-' : item.val }}
            </td>
          </tr>
          <tr *ngIf="tableInfo?.Status?.length === 0">
            <td class="text-center" colspan="2">No data.</td>
          </tr>
          </tbody>
        </table>
      </ng-template>
    </ngb-panel>

    <ngb-panel id="table-indexes">
      <ng-template ngbPanelTitle>
        <h5>INDEXES</h5>
      </ng-template>
      <ng-template ngbPanelContent>
        <i *ngIf="isTableInfoLoading" class="fa fa-spinner fa-pulse fa-3x fa-fw loading"></i>
        <div *ngIf="!isTableInfoLoading && !!indexTableError" class="alert alert-warning w-75 mx-auto m-2" role="alert">
          <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
          {{ indexTableError }}
        </div>
        <table *ngIf="!isTableInfoLoading && !indexTableError" class="table table-striped table-hover table-sm ma-0">
          <thead>
          <tr>
            <th>KeyName</th>
            <th>Type</th>
            <th>Unique</th>
            <th>Packed</th>
            <th>Column</th>
            <th>Cardinality</th>
            <th>Collation</th>
            <th>Null</th>
            <th>Comment</th>
          </tr>
          </thead>
          <tbody *ngFor="let ind of tableInfo?.Index | mapToIterable">
          <tr *ngFor="let row of ind.val; let isFirst = first">
            <td *ngIf="isFirst" [attr.rowspan]="ind.val.length">{{ row.KeyName }}</td>
            <td *ngIf="isFirst" [attr.rowspan]="ind.val.length">{{ row.IndexType }}</td>
            <td *ngIf="isFirst" [attr.rowspan]="ind.val.length">{{ row.NonUnique === false ? 'Yes' : 'No' }}</td>
            <td *ngIf="isFirst" [attr.rowspan]="ind.val.length">{{ row.Packed ? 'Yes' : 'No' }}</td>
            <td>{{ row.ColumnName }}</td>
            <td>{{ row.Cardinality }}</td>
            <td>{{ row.Collation }}</td>
            <td>{{ row.Null ? 'Yes' : 'No' }}</td>
            <td *ngIf="isFirst" [attr.rowspan]="ind.val.length">{{ row.Comment }}</td>
          </tr>
          </tbody>
          <tbody *ngIf="tableInfo?.Index?.length === 0">
          <tr>
            <td class="text-center" [attr.colspan]="9">No data.</td>
          </tr>
          </tbody>
        </table>
      </ng-template>
      <hr/>
      <h3 *ngIf="!isSummary">
        <div class="d-flex justify-content-between">
          <span>{{ queryDetails?.Query?.Abstract }}</span>
          <span>{{ queryDetails?.Query?.Id }}</span>
        </div>
      </h3>
      <h3 *ngIf="isSummary" class="d-inline">
        Server Summary
      </h3>
      <div class="card">
        <div class="card-header">
          Metrics
          <span *ngIf="!isSummary" class="pull-right">Query first seen: <i class="fa fa-clock-o"></i> {{ firstSeen }} <i
            class="fa fa-ellipsis-h" aria-hidden="true"></i> Last seen: <i
            class="fa fa-clock-o"></i> {{ lastSeen }}</span>
        </div>
        <table class="table table-striped table-hover table-sm mb-0 metrics">
          <thead>
          <tr>
            <th nowrap width="20%">Metrics</th>
            <th colspan="2">Rate/Sec</th>
            <th>Sum</th>
            <th colspan="2">Per Query Stats</th>
          </tr>
          </thead>
          <tbody *ngIf="isLoading">
          <tr>
            <td colspan="6"><i class="fa fa-spinner fa-pulse fa-3x fa-fw loading"></i></td>
          </tr>
          </tbody>
          <tbody *ngIf="!isLoading">
          <tr>
            <td>Query Count</td>
            <td class="no-right-border" align="right">{{ queryDetails?.Metrics2.Query_count_per_sec | humanize : 'number' }}
              (per sec)
            </td>
            <td style="width: 6em;" class="no-left-border">
              <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                   data-tooltip="Loading..." xkey="Ts" ykey="Query_count_per_sec" measurement="number"></div>
            </td>
            <td>
              <span class="sum">{{ queryDetails?.Metrics2.Query_count | humanize : 'number' }}</span>
              <small>
                <span *ngIf="!isSummary" class="text-primary">{{ queryDetails?.Metrics2.Query_count_of_total | humanize : 'percent' }} of total</span>
              </small>
            </td>
            <td colspan="2"></td>
          </tr>
          <tr>
            <td>Query Time</td>
            <td class="no-right-border" align="right">
              {{ queryDetails?.Metrics2.Query_time_sum_per_sec | humanize : 'number' }} load
            </td>
            <td class="no-left-border" widht="150px">
              <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                   data-tooltip="Loading..." xkey="Ts" ykey="Query_time_sum_per_sec" measurement="number"></div>
            </td>
            <td>
              <span class="sum">{{ queryDetails?.Metrics2.Query_time_sum | humanize : 'time' }}</span>
              <small>
                        <span *ngIf="!isSummary" class="text-primary">
                            {{ queryDetails?.Metrics2.Query_time_sum_of_total | humanize : 'percent' }} of total
                            </span>
              </small>
            </td>
            <td class="text-xs-right no-right-border">
              {{ queryDetails?.Metrics2.Query_time_avg | humanize : 'time' }}&nbsp;avg
            </td>
            <td style="width: 10%" class="no-left-border">
              <div class="scaling-svg-container app-tooltip"
                   data-tooltip="Loading..."
                   [appLatencyChart]="queryDetails?.Metrics2"
                   measurement="time"
                   metricPrefix="Query_time"
              ></div>
            </td>
          </tr>
          <tr *ngIf="queryDetails?.Metrics2.Lock_time_sum">
            <td>Lock Time</td>
            <td class="no-right-border" align="right">{{ queryDetails?.Metrics2.Lock_time_sum_per_sec | humanize : 'number' }}
              (avg load)
            </td>
            <td class="no-left-border">
              <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                   data-tooltip="Loading..." xkey="Ts" ykey="Lock_time_sum_per_sec" measurement="number"></div>
            </td>
            <td>
              <span class="sum">{{ queryDetails?.Metrics2.Lock_time_sum | humanize : 'time' }}</span>
              <small>
                <span *ngIf="!isSummary" class="text-primary">{{ queryDetails?.Metrics2.Lock_time_sum_of_total | humanize : 'percent'}} of total</span>
                <span class="text-success">{{ queryDetails?.Metrics2.Lock_time_avg_per_query_time | humanize : 'percent' }} of query time</span>
              </small>
            </td>
            <td class="text-xs-right no-right-border">
              {{ queryDetails?.Metrics2.Lock_time_avg | humanize : 'time' }}&nbsp;avg
            </td>
            <td style="width: 10%" class="no-left-border">
              <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="time"
                   [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="Lock_time"></div>
            </td>
          </tr>
          <tr *ngIf="queryDetails?.Metrics2.InnoDB_rec_lock_wait_sum">
            <td>Innodb Row Lock Wait</td>
            <td class="no-right-border" align="right">{{ queryDetails?.Metrics2.InnoDB_rec_lock_wait_sum_per_sec | humanize : 'number' }} (avg load)
            </td>
            <td class="no-left-border">
              <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                   data-tooltip="Loading..." xkey="Ts" ykey="InnoDB_rec_lock_wait_sum_per_sec"
                   measurement="number"></div>
            </td>
            <td>
              <span class="sum">{{ queryDetails?.Metrics2.InnoDB_rec_lock_wait_sum | humanize : 'time' }}</span>
              <small>
                <span *ngIf="queryDetails?.Metrics2.InnoDB_rec_lock_wait_sum_of_total" class="text-primary">{{ queryDetails?.Metrics2.InnoDB_rec_lock_wait_sum_of_total | humanize : 'percent' }} of total</span>
                <span class="text-success">{{ queryDetails?.Metrics2.InnoDB_rec_lock_wait_avg_per_query_time | humanize : 'percent' }} of query time</span>
              </small>
            </td>
            <td class="text-xs-right no-right-border">
              {{ queryDetails?.Metrics2.InnoDB_rec_lock_wait_avg | humanize : 'time' }}&nbsp;avg
            </td>
            <td style="width: 10%" class="no-left-border">
              <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="time"
                   [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="InnoDB_rec_lock_wait"></div>
            </td>
          </tr>
          <tr *ngIf="queryDetails?.Metrics2.InnoDB_IO_r_wait_sum">
            <td>Innodb IO Read Wait</td>
            <td class="no-right-border" align="right">{{ queryDetails?.Metrics2.InnoDB_IO_r_wait_sum_per_sec | humanize : 'number' }} (avg load)
            </td>
            <td class="no-left-border">
              <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                   data-tooltip="Loading..." xkey="Ts" ykey="InnoDB_IO_r_wait_sum_per_sec"
                   measurement="number"></div>
            </td>
            <td>
              <span class="sum">{{ queryDetails?.Metrics2.InnoDB_IO_r_wait_sum | humanize : 'time' }}</span>
              <small>
                <span *ngIf="!isSummary" class="text-primary">{{ queryDetails?.Metrics2.InnoDB_IO_r_wait_sum_of_total | humanize : 'percent' }} of total</span>
                <span class="text-success">{{ queryDetails?.Metrics2.InnoDB_IO_r_wait_avg_per_query_time | humanize : 'percent' }} of query time</span>
              </small>
            </td>
            <td class="text-xs-right no-right-border">
              {{ queryDetails?.Metrics2.InnoDB_IO_r_wait_avg | humanize : 'time' }}&nbsp;avg
            </td>
            <td style="width: 10%" class="no-left-border">
              <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="time"
                   [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="InnoDB_IO_r_wait"></div>
            </td>
          </tr>
          <tr *ngIf="queryDetails?.Metrics2.InnoDB_queue_wait_sum">
            <td>Innodb Queue Wait</td>
            <td class="no-right-border" align="right">{{ queryDetails?.Metrics2.InnoDB_queue_wait_sum_per_sec | humanize : 'number'}} (avg load)
            </td>
            <td class="no-left-border">
              <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                   data-tooltip="Loading..." xkey="Ts" ykey="InnoDB_queue_wait_sum_per_sec"
                   measurement="number"></div>
            </td>
            <td>
              <span class="sum">{{ queryDetails?.Metrics2.InnoDB_queue_wait_sum | humanize : 'time'}}</span>
              <small>
                <span *ngIf="!isSummary" class="text-primary">{{ queryDetails?.Metrics2.InnoDB_queue_wait_sum_of_total | humanize : 'percent' }} of total</span>
                <span class="text-success">{{ queryDetails?.Metrics2.innodbQueueWait.InnoDB_queue_wait_avg_per_query_time | humanize : 'percent' }} of query time</span>
              </small>
            </td>
            <td class="text-xs-right no-right-border">
              {{ queryDetails?.Metrics2.InnoDB_queue_wait_avg | humanize : 'time' }}&nbsp;avg
            </td>
            <td style="width: 10%" class="no-left-border">
              <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="time"
                   [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="InnoDB_queue_wait"></div>
            </td>
          </tr>
          <tr *ngIf="queryDetails?.Metrics2.InnoDB_IO_r_ops_sum">
            <td>Innodb Read Ops</td>
            <td class="no-right-border" align="right">{{ queryDetails?.Metrics2.InnoDB_IO_r_ops_sum_per_sec | humanize : 'number' }} (per sec)
            </td>
            <td class="no-left-border">
              <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                   data-tooltip="Loading..." xkey="Ts" ykey="InnoDB_IO_r_ops_sum_per_sec"
                   measurement="number"></div>
            </td>
            <td>
              <span class="sum">{{ queryDetails?.Metrics2.InnoDB_IO_r_ops_sum | humanize : 'number' }}</span>
              <small>
                <span *ngIf="!isSummary" class="text-primary">{{ queryDetails?.Metrics2.InnoDB_IO_r_ops_sum_of_total | humanize : 'percent' }} of total</span>
              </small>
            </td>
            <td class="text-xs-right no-right-border">
              {{ queryDetails?.Metrics2.InnoDB_IO_r_ops_avg | humanize : 'number' }}&nbsp;avg
            </td>
            <td style="width: 10%" class="no-left-border">
              <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="number"
                   [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="InnoDB_IO_r_ops"></div>
            </td>
          </tr>
          <tr *ngIf="queryDetails?.Metrics2.InnoDB_IO_r_bytes_sum">
            <td>Innodb Read Bytes</td>
            <td class="no-right-border" align="right">{{ queryDetails?.Metrics2.InnoDB_IO_r_bytes_sum_per_sec | humanize : 'size'}} (per sec)
            </td>
            <td class="no-left-border">
              <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                   data-tooltip="Loading..." xkey="Ts" ykey="InnoDB_IO_r_bytes_sum_per_sec"
                   measurement="size"></div>
            </td>
            <td>
              <span class="sum">{{ queryDetails?.Metrics2.InnoDB_IO_r_bytes_sum | humanize : 'size' }}</span>
              <small>
                <span *ngIf="!isSummary" class="text-primary">{{ queryDetails?.Metrics2.InnoDB_IO_r_bytes_sum_of_total | humanize : 'percent' }} of total</span>
                <span class="text-success">{{ queryDetails?.Metrics2.InnoDB_IO_r_bytes_sum_per_io | humanize : 'size' }} avg io size</span>
              </small>
            </td>
            <td class="text-xs-right no-right-border">
              {{ queryDetails?.Metrics2.InnoDB_IO_r_bytes_avg | humanize : 'size' }}&nbsp;avg
            </td>
            <td style="width: 10%" class="no-left-border">
              <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="size"
                   [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="InnoDB_IO_r_bytes"></div>
            </td>
          </tr>
          <tr *ngIf="queryDetails?.Metrics2.InnoDB_pages_distinct_sum">
            <td>Innodb Distinct Pages</td>
            <td colspan="2" align="right">-</td>
            <td><span class="sum">-</span></td>
            <td class="text-xs-right no-right-border">
              {{ queryDetails?.Metrics2.InnoDB_pages_distinct_avg | humanize : 'number' }}&nbsp;avg
            </td>
            <td style="width: 10%" class="no-left-border">
              <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="number"
                   [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="InnoDB_pages_distinct"></div>
            </td>
          </tr>
          <tr *ngIf="queryDetails?.Metrics2.QC_Hit_sum">
            <td>Query Cache Hits</td>
            <td class="no-right-border" align="right">{{ queryDetails?.Metrics2.QC_Hit_sum_per_sec | humanize : 'number' }}
              (per sec)
            </td>
            <td class="no-left-border">
              <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                   data-tooltip="Loading..." xkey="Ts" ykey="QC_Hit_sum_per_sec" measurement="number"></div>
            </td>
            <td>
              <span class="sum">{{ queryDetails?.Metrics2.QC_Hit_sum | humanize : 'number' }}</span>
              <small>
                <span *ngIf="!isSummary" class="text-primary">{{ queryDetails?.Metrics2.QC_Hit_sum_of_total | humanize : 'percent' }} of total</span>
                <span class="text-success">{{ queryDetails?.Metrics2.QC_Hit_sum_per_query | humanize : 'percent'}} QC hit ratio</span>
              </small>
            </td>
            <td class="text-xs-right no-right-border">
              -
            </td>
            <td style="width: 10%" class="no-left-border">
            </td>
          </tr>
          <tr *ngIf="queryDetails?.Metrics2.Rows_sent_sum">
            <td>Rows Sent</td>
            <td class="no-right-border" align="right">{{ queryDetails?.Metrics2.Rows_sent_sum_per_sec | humanize : 'number' }}
              (per sec)
            </td>
            <td class="no-left-border">
              <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                   data-tooltip="Loading..." xkey="Ts" ykey="Rows_sent_sum_per_sec" measurement="number"></div>
            </td>
            <td>
              <span class="sum">{{ queryDetails?.Metrics2.Rows_sent_sum | humanize : 'number' }}</span>
              <small>
                <span *ngIf="!isSummary" class="text-primary">{{ queryDetails?.Metrics2.Rows_sent_sum_of_total | humanize : 'percent' }} of total</span>
              </small>
            </td>
            <td class="text-xs-right no-right-border">
              {{ queryDetails?.Metrics2.Rows_sent_avg | humanize : 'number' }}&nbsp;avg
            </td>
            <td style="width: 10%" class="no-left-border">
              <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="number"
                   [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="Rows_sent"></div>
            </td>
          </tr>
          <tr *ngIf="queryDetails?.Metrics2.Bytes_sent_sum">
            <td>Bytes Sent</td>
            <td class="no-right-border" align="right">{{ queryDetails?.Metrics2.Bytes_sent_sum_per_sec | humanize : 'size' }}
              (per sec)
            </td>
            <td class="no-left-border">
              <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                   data-tooltip="Loading..." xkey="Ts" ykey="Bytes_sent_sum_per_sec" measurement="size"></div>
            </td>
            <td>
              <span class="sum">{{ queryDetails?.Metrics2.Bytes_sent_sum | humanize : 'size' }}</span>
              <small>
                <span *ngIf="!isSummary" class="text-primary">{{ queryDetails?.Metrics2.Bytes_sent_sum_of_total | humanize : 'percent' }} of total</span>
                <span class="text-success" ng-if="queryDetails?.Metrics2.Bytes_sent_sum_per_rows">{{ queryDetails?.Metrics2.Bytes_sent_sum_per_rows | humanize : 'size' }} bytes/row</span>
              </small>
            </td>
            <td class="text-xs-right no-right-border">
              {{ queryDetails?.Metrics2.Bytes_sent_avg | humanize : 'size' }}&nbsp;avg
            </td>
            <td style="width: 10%" class="no-left-border">
              <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="size"
                   [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="Bytes_sent"></div>
            </td>
          </tr>
          <tr *ngIf="queryDetails?.Metrics2.Rows_examined_sum">
            <td>Rows Examined</td>
            <td class="no-right-border" align="right">{{ queryDetails?.Metrics2.Rows_examined_sum_per_sec | humanize : 'number' }} (per sec)
            </td>
            <td class="no-left-border">
              <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                   data-tooltip="Loading..." xkey="Ts" ykey="Rows_examined_sum_per_sec" measurement="number"></div>
            </td>
            <td>
              <span class="sum">{{ queryDetails?.Metrics2.Rows_examined_sum | humanize : 'number' }}</span>
              <small>
                <span *ngIf="!isSummary" class="text-primary">{{ queryDetails?.Metrics2.Rows_examined_sum_of_total | humanize : 'percent' }} of total</span>
                <span class="text-success">{{ queryDetails?.Metrics2.Rows_examined_sum_per_rows | humanize : 'number' }} per row sent</span>
              </small>
            </td>
            <td class="text-xs-right no-right-border">
              {{ queryDetails?.Metrics2.Rows_examined_avg | humanize : 'number' }}&nbsp;avg
            </td>
            <td style="width: 10%" class="no-left-border">
              <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="number"
                   [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="Rows_examined"></div>
            </td>
          </tr>
          <tr *ngIf="queryDetails?.Metrics2.Rows_affected_sum">
            <td>Rows Affected</td>
            <td class="no-right-border" align="right">{{ queryDetails?.Metrics2.Rows_affected_sum_per_sec | humanize : 'number' }} (per sec)
            </td>
            <td class="no-left-border">
              <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                   data-tooltip="Loading..." xkey="Ts" ykey="Rows_affected_sum_per_sec" measurement="number"></div>
            </td>
            <td>
              <span class="sum">{{ queryDetails?.Metrics2.Rows_affected_sum | humanize : 'number'}}</span>
              <small>
                <span *ngIf="!isSummary" class="text-primary">{{ queryDetails?.Metrics2.Rows_affected_sum_of_total | humanize : 'percent' }} of total</span>
              </small>
            </td>
            <td class="text-xs-right no-right-border">
              {{ queryDetails?.Metrics2.Rows_affected_avg | humanize : 'number' }}&nbsp;avg
            </td>
            <td style="width: 10%" class="no-left-border">
              <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="number"
                   [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="Rows_affected"></div>
            </td>
          </tr>
          <tr *ngIf="queryDetails?.Metrics2.Filesort_sum">
            <!-- no avg -->
            <td>External Sorts
              <small>(Filesort)</small>
            </td>
            <td class="no-right-border" align="right">{{ queryDetails?.Metrics2.Filesort_sum_per_sec | humanize : 'number' }}
              (per sec)
            </td>
            <td class="no-left-border">
              <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                   data-tooltip="Loading..." xkey="Ts" ykey="Filesort_sum_per_sec" measurement="number"></div>
            </td>
            <td>
              <span class="sum">{{ queryDetails?.Metrics2.Filesort_sum | humanize : 'number' }}</span>
              <small>
                <span *ngIf="!isSummary" class="text-primary">{{ queryDetails?.Metrics2.Filesort_sum_of_total | humanize : 'percent' }} of total</span>
                <span class="text-success">{{ queryDetails?.Metrics2.Filesort_sum_per_query | humanize : 'percent' }} of queries</span>
              </small>
            </td>
            <td class="text-xs-right no-right-border">
              -
            </td>
            <td style="width: 10%" class="no-left-border">
            </td>
          </tr>
          <tr *ngIf="queryDetails?.Metrics2.Filesort_on_disk_sum">
            <td>External Sorts of Disk
              <small>(Filesort on disk)</small>
            </td>
            <td class="no-right-border" align="right">{{ queryDetails?.Metrics2.Filesort_on_disk_sum_per_sec | humanize : 'number' }} (per sec)
            </td>
            <td class="no-left-border">
              <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                   data-tooltip="Loading..." xkey="Ts" ykey="Filesort_on_disk_sum_per_sec"
                   measurement="number"></div>
            </td>
            <td>
              <span class="sum">{{ queryDetails?.Metrics2.Filesort_on_disk_sum | humanize : 'number' }}</span>
              <small>
                <span *ngIf="!isSummary" class="text-primary">{{ queryDetails?.Metrics2.Filesort_on_disk_sum_of_total | humanize : 'percent' }} of total</span>
                <span class="text-success">{{ queryDetails?.Metrics2.Filesort_on_disk_sum_per_query | humanize : 'percent' }} of queries</span>
              </small>
            </td>
            <td class="text-xs-right no-right-border">
              -
            </td>
            <td style="width: 10%" class="no-left-border">
            </td>
          </tr>
          <tr *ngIf="queryDetails?.Metrics2.Merge_passes_sum">
            <td>External Sort Passes
              <small>(Merge Passes)</small>
            </td>
            <td class="no-right-border" align="right">{{ queryDetails?.Metrics2.Merge_passes_sum_per_sec | humanize : 'number' }} (per sec)
            </td>
            <td class="no-left-border">
              <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                   data-tooltip="Loading..." xkey="Ts" ykey="Merge_passes_sum_per_sec" measurement="number"></div>
            </td>
            <td>
              <span class="sum">{{ queryDetails?.Metrics2.Merge_passes_sum | humanize : 'number' }}</span>
              <small>
                <span *ngIf="!isSummary" class="text-primary">{{ queryDetails?.Metrics2.Merge_passes_sum_of_total | humanize : 'percent' }} of total</span>
                <span class="text-success">{{ queryDetails?.Metrics2.Merge_passes_sum_per_external_sort | humanize : 'percent' }} per external sort</span>
              </small>
            </td>
            <td class="text-xs-right no-right-border">
              {{ queryDetails?.Metrics2.Merge_passes_avg | humanize : 'number' }}&nbsp;avg
            </td>
            <td style="width: 10%" class="no-left-border">
              <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="number"
                   [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="Merge_passes"></div>
            </td>
          </tr>
          <tr *ngIf="queryDetails?.Metrics2.Full_join_sum">
            <td>Cartesian Products
              <small>(Full Joins)</small>
            </td>
            <td class="no-right-border" align="right">{{ queryDetails?.Metrics2.Full_join_sum_per_sec | humanize : 'number' }}
              (per sec)
            </td>
            <td class="no-left-border">
              <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                   data-tooltip="Loading..." xkey="Ts" ykey="Full_join_sum_per_sec" measurement="number"></div>
            </td>
            <td>
              <span class="sum">{{ queryDetails?.Metrics2.Full_join_sum | humanize : 'number' }}</span>
              <small>
                <span *ngIf="!isSummary" class="text-primary">{{ queryDetails?.Metrics2.Full_join_sum_of_total | humanize : 'percent' }} of total</span>
                <span class="text-success">{{ queryDetails?.Metrics2.Full_join_sum_per_query | humanize : 'percent' }} of queries</span>
              </small>
            </td>
            <td class="text-xs-right no-right-border">
              -
            </td>
            <td style="width: 10%" class="no-left-border">
            </td>
          </tr>
          <tr *ngIf="queryDetails?.Metrics2.Full_scan_sum">
            <td>Full Table Scans</td>
            <td class="no-right-border" align="right">{{ queryDetails?.Metrics2.Full_scan_sum_per_sec | humanize : 'number' }}
              (per sec)
            </td>
            <td class="no-left-border">
              <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                   data-tooltip="Loading..." xkey="Ts" ykey="Full_scan_sum_per_sec" measurement="number"></div>
            </td>
            <td>
              <span class="sum">{{ queryDetails?.Metrics2.Full_scan_sum | humanize : 'number' }}</span>
              <small>
                <span *ngIf="!isSummary" class="text-primary">{{ queryDetails?.Metrics2.Full_scan_sum_of_total | humanize : 'percent' }} of total</span>
                <span class="text-success">{{ queryDetails?.Metrics2.Full_scan_sum_per_query | humanize : 'percent' }} of queries</span>
              </small>
            </td>
            <td class="text-xs-right no-right-border">
              -
            </td>
            <td style="width: 10%" class="no-left-border">
            </td>
          </tr>
          <tr *ngIf="queryDetails?.Metrics2.Tmp_table_sum">
            <td>Queries Requiring Tmp Table In Memory</td>
            <td class="no-right-border" align="right">{{ queryDetails?.Metrics2.Tmp_table_sum_per_sec | humanize : 'number' }}
              (per sec)
            </td>
            <td class="no-left-border">
              <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                   data-tooltip="Loading..." xkey="Ts" ykey="Tmp_table_sum_per_sec" measurement="number"></div>
            </td>
            <td>
              <span class="sum">{{ queryDetails?.Metrics2.Tmp_table_sum | humanize : 'number' }}</span>
              <small>
                <span *ngIf="!isSummary" class="text-primary">{{ queryDetails?.Metrics2.Tmp_table_sum_of_total | humanize : 'percent' }} of total</span>
                <span class="text-success">{{ queryDetails?.Metrics2.Tmp_table_sum_per_query | humanize : 'percent' }} of queries</span>
              </small>
            </td>
            <td class="text-xs-right no-right-border">
              -
            </td>
            <td style="width: 10%" class="no-left-border">
            </td>
          </tr>
          <tr *ngIf="queryDetails?.Metrics2.Tmp_tables_sum">
            <td>Number of Tmp table in Memory</td>
            <td class="no-right-border" align="right">{{ queryDetails?.Metrics2.Tmp_tables_sum_per_sec | humanize : 'number' }} (per sec)
            </td>
            <td class="no-left-border">
              <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                   data-tooltip="Loading..." xkey="Ts" ykey="Tmp_tables_sum_per_sec" measurement="number"></div>
            </td>
            <td>
              <span class="sum">{{ queryDetails?.Metrics2.Tmp_tables_sum | humanize : 'number' }}</span>
              <small>
                <span *ngIf="!isSummary" class="text-primary">{{ queryDetails?.Metrics2.Tmp_tables_sum_of_total | humanize : 'percent' }} of total</span>
                <span class="text-success">{{ queryDetails?.Metrics2.Tmp_tables_sum_per_query_with_tmp_table | humanize : 'number'}} per query with tmp table</span>
              </small>
            </td>
            <td class="text-xs-right no-right-border">
              {{ queryDetails?.Metrics2.Tmp_tables_avg | humanize : 'number' }}&nbsp;avg
            </td>
            <td style="width: 10%" class="no-left-border">
              <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="number"
                   [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="Tmp_tables"></div>
            </td>
          </tr>
          <tr *ngIf="queryDetails?.Metrics2.Tmp_table_on_disk_sum">
            <td>Queries Requiring Tmp Table on Disk</td>
            <td class="no-right-border" align="right">{{ queryDetails?.Metrics2.Tmp_table_on_disk_sum_per_sec | humanize : 'number' }} (per sec)
            </td>
            <td class="no-left-border">
              <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                   data-tooltip="Loading..." xkey="Ts" ykey="Tmp_table_on_disk_sum_per_sec"
                   measurement="number"></div>
            </td>
            <td>
              <span class="sum">{{ queryDetails?.Metrics2.Tmp_table_on_disk_sum | humanize : 'number' }}</span>
              <small>
                <span *ngIf="!isSummary" class="text-primary">{{ queryDetails?.Metrics2.Tmp_table_on_disk_sum_of_total | humanize : 'percent' }} of total</span>
                <span class="text-success">{{ queryDetails?.Metrics2.Tmp_table_on_disk_sum_per_query | humanize : 'percent' }} of queries</span>
              </small>
            </td>
            <td class="text-xs-right no-right-border">
              -
            </td>
            <td style="width: 10%" class="no-left-border">
            </td>
          </tr>
          <tr *ngIf="queryDetails?.Metrics2.Tmp_disk_tables_sum">
            <td>Number of Tmp Tables on Disk</td>
            <td class="no-right-border" align="right">{{ queryDetails?.Metrics2.Tmp_disk_tables_sum_per_sec | humanize : 'number' }} (per sec)
            </td>
            <td class="no-left-border">
              <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                   data-tooltip="Loading..." xkey="Ts" ykey="Tmp_disk_tables_sum_per_sec"
                   measurement="number"></div>
            </td>
            <td>
              <span class="sum">{{ queryDetails?.Metrics2.Tmp_disk_tables_sum | humanize : 'number' }}</span>
              <small>
                <span *ngIf="!isSummary" class="text-primary">{{ queryDetails?.Metrics2.Tmp_disk_tables_sum_of_total | humanize : 'percent' }} of total</span>
                <span class="text-success">{{ queryDetails?.Metrics2.Tmp_disk_tables_sum_per_query_with_tmp_table | humanize : 'number' }} per query with disk tmp table</span>
              </small>
            </td>
            <td class="text-xs-right no-right-border">
              {{ queryDetails?.Metrics2.Tmp_disk_tables_avg | humanize : 'number' }}&nbsp;avg
            </td>
            <td style="width: 10%" class="no-left-border">
              <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="number"
                   [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="Tmp_disk_tables"></div>
            </td>
          </tr>
          <tr *ngIf="queryDetails?.Metrics2.Tmp_table_sizes_sum">
            <td>Total Size of Tmp Tables</td>
            <td class="no-right-border" align="right">{{ queryDetails?.Metrics2.Tmp_table_sizes_sum_per_sec | humanize : 'size' }} (per sec)
            </td>
            <td class="no-left-border">
              <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                   data-tooltip="Loading..." xkey="Ts" ykey="Tmp_table_sizes_sum_per_sec"
                   measurement="size"></div>
            </td>
            <td>
              <span class="sum">{{ queryDetails?.Metrics2.Tmp_table_sizes_sum | humanize : 'size' }}</span>
              <small>
                <span *ngIf="!isSummary" class="text-primary">{{ queryDetails?.Metrics2.Tmp_table_sizes_sum_of_total | humanize : 'percent' }} of total</span>
                <span class="text-success">{{ queryDetails?.Metrics2.Tmp_table_sizes_sum_per_query_with_any_tmp_table | humanize : 'size' }} per query</span>
              </small>
            </td>
            <td class="text-xs-right no-right-border">
              {{ queryDetails?.Metrics2.Tmp_table_sizes_avg | humanize : 'size' }}&nbsp;avg
            </td>
            <td style="width: 10%" class="no-left-border">
              <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="size"
                   [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="Tmp_table_sizes"></div>
            </td>
          </tr>
          </tbody>
        </table>

      </div>

      <!--- additional info for query only-->
      <div *ngIf="!isSummary">
        <hr/>
        <h3 class="d-inline">QUERY</h3>
        <ngb-accordion activeIds="query-fingerprint">
          <ngb-panel id="query-fingerprint">
            <ng-template ngbPanelTitle>
              <h5>Fingerprint</h5>
            </ng-template>
            <ng-template ngbPanelContent>
              <i *ngIf="isLoading" class="fa fa-spinner fa-pulse fa-3x fa-fw loading"></i>
              <pre *ngIf="!isLoading" style="margin: 1rem"><code [innerHTML]="fingerprint"
                                                                 id="query_fingerprint_code"></code></pre>
            </ng-template>
          </ngb-panel>
          <ngb-panel *ngIf="!!queryExample" id="query-example">
            <ng-template ngbPanelTitle>
              <h5>Example</h5>
            </ng-template>
            <ng-template ngbPanelContent>
              <i *ngIf="isLoading" class="fa fa-spinner fa-pulse fa-3x fa-fw loading"></i>
              <pre *ngIf="!isLoading" style="margin: 1rem"><code [innerHTML]="queryExample"
                                                                 id="query_example_code"></code></pre>
            </ng-template>
          </ngb-panel>
        </ngb-accordion>

        <hr *ngIf="!!queryExample"/>
        <div class="row" *ngIf="!!queryExample">
    <span class="col-md-2">
        <h3 class="d-inline">EXPLAIN</h3>
    </span>
          <div class="col-md-10">
            <form class="form-inline pull-right">
              <div class="input-group">
                <span class="input-group-addon" id="sizing-addon1" title="Database">
                    <i class="fa fa-database" aria-hidden="true"></i>
                </span>
                <input type="text" size="50" class="form-control" [(ngModel)]="dbName"
                       [ngModelOptions]="{standalone: true}"
                       id="databaseInput"
                       placeholder="`database-name`">
                <span class="input-group-btn">
                    <button class="btn btn-primary" [disabled]="!dbName" style="width: 8em" (click)="getExplain();"
                            type="submit">EXPLAIN</button>
                </span>
              </div>
            </form>
          </div>
        </div>
        <br/>
        <ngb-accordion activeIds="classic-explain" *ngIf="!!queryExample">
          <ngb-panel id="classic-explain">
            <ng-template ngbPanelTitle>
              <h5>CLASSIC</h5>
            </ng-template>
            <ng-template ngbPanelContent>
              <i *ngIf="isExplainLoading" class="fa fa-spinner fa-pulse fa-3x fa-fw loading"></i>
              <div *ngIf="!isExplainLoading && classicExplainError" class="alert alert-warning w-75 mx-auto m-2"
                   role="alert">
                <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
                {{ jsonExplainError }}
              </div>
              <table *ngIf="!isExplainLoading && !classicExplainError"
                     class="table table-striped table-hover table-sm ma-0">
                <thead>
                <tr>
                  <th width="3%" title="Id">Id</th>
                  <th title="SelectType">SelectType</th>
                  <th title="Table">Table</th>
                  <th title="Partitions">Partitions</th>
                  <th title="CreateTable">CreateTable</th>
                  <th title="Type">Type</th>
                  <th title="PossibleKeys">PossibleKeys</th>
                  <th title="Key">Key</th>
                  <th title="KeyLen">KeyLen</th>
                  <th width="5%" title="Ref">Ref</th>
                  <th title="Rows">Rows</th>
                  <th title="Extra">Extra</th>
                </tr>
                </thead>
                <tbody>
                <tr *ngFor="let row of classicExplain">
                  <td [attr.title]="row.Id">{{ row.Id }}</td>
                  <td [attr.title]="row.SelectType">{{ row.SelectType }}</td>
                  <td [attr.title]="row.Table">{{ row.Table }}</td>
                  <td [attr.title]="row.Partitions">{{ row.Partitions }}</td>
                  <td [attr.title]="row.CreateTable">{{ row.CreateTable }}</td>
                  <td [attr.title]="row.Type">{{ row.Type }}</td>
                  <td [attr.title]="row.PossibleKeys">{{ row?.PossibleKeys?.replace(',', ', ') }}</td>
                  <td [attr.title]="row.Key">{{ row.Key }}</td>
                  <td [attr.title]="row.KeyLen">{{ row.KeyLen }}</td>
                  <td [attr.title]="row.Ref">{{ row.Ref }}</td>
                  <td [attr.title]="row.Rows">{{ row.Rows }}</td>
                  <td [attr.title]="row.Extra">{{ row.Extra }}</td>
                </tr>
                </tbody>
              </table>
            </ng-template>
          </ngb-panel>

          <ngb-panel id="json-explain" *ngIf="!!jsonExplain || !!jsonExplainError">
            <ng-template ngbPanelTitle>
              <h5>JSON</h5>
            </ng-template>
            <ng-template ngbPanelContent>
              <i *ngIf="isExplainLoading" class="fa fa-spinner fa-pulse fa-3x fa-fw loading"></i>
              <app-json-tree [json]="jsonExplain" *ngIf="!isExplainLoading && !jsonExplainError"></app-json-tree>
              <div *ngIf="!isExplainLoading && jsonExplainError" class="alert alert-warning w-75 mx-auto m-2"
                   role="alert">
                <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
                {{ jsonExplainError }}
              </div>
            </ng-template>
          </ngb-panel>
        </ngb-accordion>

        <hr/>
        <div class="row">
    <span class="col-md-2">
        <h3 class="d-inline">TABLES</h3>
    </span>
          <div class="col-md-10">
            <form class="form-inline pull-right" (submit)="addDBTable();">
              <label for="dbTblNamesInput">DB and table</label>&nbsp;
              <div class="input-group">
                <input type="text" size="50" class="form-control"
                       id="dbTblNamesInput" [(ngModel)]="newDBTblNames"
                       [ngModelOptions]="{standalone: true}"
                       placeholder="`database-name`.`table-name`">
                <span class="input-group-btn">
                    <button [disabled]="isDemo || !newDBTblNames" class="btn btn-primary" (click)="addDBTable();"
                            style="width: 8em" type="submit">ADD</button>
                </span>
              </div>
            </form>
          </div>
        </div>

        <br/>

        <div class="row">
          <div class="col-md-12">
            <div class="card w-100">
              <div class="card-block" id="db_tables_buttons">
                <div class="card-text pt-1 pr-1">
                  <div *ngFor="let item of queryDetails?.Query?.Tables" class="btn-group ml-1 mb-1" role="group"
                       aria-label="Tables">
                    <button type="button" class="btn" (click)="selectTableInfo(item.Db, item.Table);"
                            [ngClass]="isSelectedDbTbl(item) ? 'btn-success' : 'btn-secondary'">
                      `{{ item.Db }}`.`{{ item.Table }}`
                    </button>
                    <button type="button" class="btn btn-warning" (click)="removeDBTable(item);"><i class="fa fa-times"
                                                                                                    aria-hidden="true"></i>
                    </button>
                  </div>
                  <div *ngIf="queryDetails?.Query?.Tables === null || queryDetails?.Query?.Tables?.length === 0"
                       class="alert alert-info w-25 mx-auto m-2" role="alert">
                    <i class="fa fa-info-circle" aria-hidden="true"></i>
                    List of tables is empty.
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <br/>
        <ngb-accordion activeIds="table-create" *ngIf="queryDetails?.Query?.Tables?.length">
          <ngb-panel id="table-create">
            <ng-template ngbPanelTitle>
              <h5>CREATE</h5>
            </ng-template>
            <ng-template ngbPanelContent>
              <i *ngIf="isTableInfoLoading" class="fa fa-spinner fa-pulse fa-3x fa-fw loading"></i>
              <div *ngIf="!isTableInfoLoading && createTableError" class="alert alert-warning w-75 mx-auto m-2"
                   role="alert">
                <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
                {{ createTableError }}
              </div>
              <pre *ngIf="!isTableInfoLoading && !createTableError" style="margin: 1rem"><code [innerHTML]="createTable"
                                                                                               id="table_create"></code></pre>
            </ng-template>
          </ngb-panel>

          <ngb-panel id="table-status">
            <ng-template ngbPanelTitle>
              <h5>STATUS</h5>
            </ng-template>
            <ng-template ngbPanelContent>
              <i *ngIf="isTableInfoLoading" class="fa fa-spinner fa-pulse fa-3x fa-fw loading"></i>
              <div *ngIf="!isTableInfoLoading && !!statusTableError" class="alert alert-warning w-75 mx-auto m-2"
                   role="alert">
                <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
                {{ statusTableError }}
              </div>
              <table *ngIf="!isTableInfoLoading && !statusTableError"
                     class="table table-striped table-hover table-sm ma-0">
                <thead>
                <tr>
                  <th>Name</th>
                  <th>Value</th>
                </tr>
                </thead>
                <tbody>
                <tr *ngFor="let item of tableInfo?.Status | mapToIterable">
                  <td>{{ item.key }}</td>
                  <td
                    *ngIf="['AvgRowLength', 'DataLength', 'IndexLength', 'DataFree', 'MaxDataLength'].indexOf(item.key) > -1">
                    {{ item.val | humanize : 'size' }}
                  </td>
                  <td *ngIf="['Rows'].indexOf(item.key) > -1">{{ item.val | humanize : 'number' }}</td>
                  <td
                    *ngIf="['Rows', 'AvgRowLength', 'DataLength', 'IndexLength', 'DataFree', 'MaxDataLength'].indexOf(item.key) === -1">
                    {{ item.val === null ? '-' : item.val }}
                  </td>
                </tr>
                <tr *ngIf="tableInfo?.Status?.length === 0">
                  <td class="text-center" colspan="2">No data.</td>
                </tr>
                </tbody>
              </table>
            </ng-template>
          </ngb-panel>

          <ngb-panel id="table-indexes">
            <ng-template ngbPanelTitle>
              <h5>INDEXES</h5>
            </ng-template>
            <ng-template ngbPanelContent>
              <i *ngIf="isTableInfoLoading" class="fa fa-spinner fa-pulse fa-3x fa-fw loading"></i>
              <div *ngIf="!isTableInfoLoading && !!indexTableError" class="alert alert-warning w-75 mx-auto m-2"
                   role="alert">
                <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
                {{ indexTableError }}
              </div>
              <table *ngIf="!isTableInfoLoading && !indexTableError"
                     class="table table-striped table-hover table-sm ma-0">
                <thead>
                <tr>
                  <th>KeyName</th>
                  <th>Type</th>
                  <th>Unique</th>
                  <th>Packed</th>
                  <th>Column</th>
                  <th>Cardinality</th>
                  <th>Collation</th>
                  <th>Null</th>
                  <th>Comment</th>
                </tr>
                </thead>
                <tbody *ngFor="let ind of tableInfo?.Index | mapToIterable">
                <tr *ngFor="let row of ind.val; let isFirst = first">
                  <td *ngIf="isFirst" [attr.rowspan]="ind.val.length">{{ row.KeyName }}</td>
                  <td *ngIf="isFirst" [attr.rowspan]="ind.val.length">{{ row.IndexType }}</td>
                  <td *ngIf="isFirst" [attr.rowspan]="ind.val.length">{{ row.NonUnique === false ? 'Yes' : 'No' }}</td>
                  <td *ngIf="isFirst" [attr.rowspan]="ind.val.length">{{ row.Packed ? 'Yes' : 'No' }}</td>
                  <td>{{ row.ColumnName }}</td>
                  <td>{{ row.Cardinality }}</td>
                  <td>{{ row.Collation }}</td>
                  <td>{{ row.Null ? 'Yes' : 'No' }}</td>
                  <td *ngIf="isFirst" [attr.rowspan]="ind.val.length">{{ row.Comment }}</td>
                </tr>
                </tbody>
                <tbody *ngIf="tableInfo?.Index?.length === 0">
                <tr>
                  <td class="text-center" [attr.colspan]="9">No data.</td>
                </tr>
                </tbody>
              </table>
            </ng-template>
          </ngb-panel>
        </ngb-accordion>
      </div>

    </ngb-panel>
  </ngb-accordion>
</div>
